{"version":3,"file":"uv.handler.js","mappings":"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","sources":["webpack://@titaniumnetwork-dev/ultraviolet/./src/uv.handler.js"],"sourcesContent":["/**\n * @type {import('../uv').UltravioletCtor}\n */\nconst Ultraviolet = self.Ultraviolet;\n\n/**\n * @type {import('../uv').UVClientCtor}\n */\nconst UVClient = self.UVClient;\n\n/**\n * @type {import('../uv').UVConfig}\n */\nconst __uv$config = self.__uv$config;\n\n/**\n * @type {import('@tomphttp/bare-client').BareManifest}\n */\nconst __uv$bareData = self.__uv$bareData;\n\n/**\n * @type {string}\n */\nconst __uv$bareURL = self.__uv$bareURL;\n\n/**\n * @type {string}\n */\nconst __uv$cookies = self.__uv$cookies;\n\nif (\n    typeof __uv$bareData !== 'object' ||\n    typeof __uv$bareURL !== 'string' ||\n    typeof __uv$cookies !== 'string'\n)\n    throw new TypeError('Unable to load global UV data');\n\nif (!self.__uv) __uvHook(self);\n\nself.__uvHook = __uvHook;\n\nfunction __uvHook(window) {\n    if ('__uv' in window && window.__uv instanceof Ultraviolet) return false;\n\n    if (window.document && !!window.window) {\n        window.document\n            .querySelectorAll('script[__uv-script]')\n            .forEach((node) => node.remove());\n    }\n\n    const worker = !window.window;\n    const master = '__uv';\n    const methodPrefix = '__uv$';\n    const __uv = new Ultraviolet(__uv$config);\n\n    /*if (typeof config.construct === 'function') {\n        config.construct(__uv, worker ? 'worker' : 'window');\n    }*/\n\n    const client = new UVClient(window);\n    const {\n        HTMLMediaElement,\n        HTMLScriptElement,\n        HTMLAudioElement,\n        HTMLVideoElement,\n        HTMLInputElement,\n        HTMLEmbedElement,\n        HTMLTrackElement,\n        HTMLAnchorElement,\n        HTMLIFrameElement,\n        HTMLAreaElement,\n        HTMLLinkElement,\n        HTMLBaseElement,\n        HTMLFormElement,\n        HTMLImageElement,\n        HTMLSourceElement,\n    } = window;\n\n    client.nativeMethods.defineProperty(window, '__uv', {\n        value: __uv,\n        enumerable: false,\n    });\n\n    __uv.meta.origin = location.origin;\n    __uv.location = client.location.emulate(\n        (href) => {\n            if (href === 'about:srcdoc') return new URL(href);\n            if (href.startsWith('blob:')) href = href.slice('blob:'.length);\n            return new URL(__uv.sourceUrl(href));\n        },\n        (href) => {\n            return __uv.rewriteUrl(href);\n        }\n    );\n\n    let cookieStr = __uv$cookies;\n\n    __uv.meta.url = __uv.location;\n    __uv.domain = __uv.meta.url.host;\n    __uv.blobUrls = new window.Map();\n    __uv.referrer = '';\n    __uv.cookies = [];\n    __uv.localStorageObj = {};\n    __uv.sessionStorageObj = {};\n\n    // websockets\n    const bareClient = new Ultraviolet.BareClient(__uv$bareURL, __uv$bareData);\n\n    if (__uv.location.href === 'about:srcdoc') {\n        __uv.meta = window.parent.__uv.meta;\n    }\n\n    if (window.EventTarget) {\n        __uv.addEventListener = window.EventTarget.prototype.addEventListener;\n        __uv.removeListener = window.EventTarget.prototype.removeListener;\n        __uv.dispatchEvent = window.EventTarget.prototype.dispatchEvent;\n    }\n\n    // Storage wrappers\n    client.nativeMethods.defineProperty(\n        client.storage.storeProto,\n        '__uv$storageObj',\n        {\n            get() {\n                if (this === client.storage.sessionStorage)\n                    return __uv.sessionStorageObj;\n                if (this === client.storage.localStorage)\n                    return __uv.localStorageObj;\n            },\n            enumerable: false,\n        }\n    );\n\n    if (window.localStorage) {\n        for (const key in window.localStorage) {\n            if (key.startsWith(methodPrefix + __uv.location.origin + '@')) {\n                __uv.localStorageObj[\n                    key.slice(\n                        (methodPrefix + __uv.location.origin + '@').length\n                    )\n                ] = window.localStorage.getItem(key);\n            }\n        }\n\n        __uv.lsWrap = client.storage.emulate(\n            client.storage.localStorage,\n            __uv.localStorageObj\n        );\n    }\n\n    if (window.sessionStorage) {\n        for (const key in window.sessionStorage) {\n            if (key.startsWith(methodPrefix + __uv.location.origin + '@')) {\n                __uv.sessionStorageObj[\n                    key.slice(\n                        (methodPrefix + __uv.location.origin + '@').length\n                    )\n                ] = window.sessionStorage.getItem(key);\n            }\n        }\n\n        __uv.ssWrap = client.storage.emulate(\n            client.storage.sessionStorage,\n            __uv.sessionStorageObj\n        );\n    }\n\n    let rawBase = window.document\n        ? client.node.baseURI.get.call(window.document)\n        : window.location.href;\n    let base = __uv.sourceUrl(rawBase);\n\n    client.nativeMethods.defineProperty(__uv.meta, 'base', {\n        get() {\n            if (!window.document) return __uv.meta.url.href;\n\n            if (client.node.baseURI.get.call(window.document) !== rawBase) {\n                rawBase = client.node.baseURI.get.call(window.document);\n                base = __uv.sourceUrl(rawBase);\n            }\n\n            return base;\n        },\n    });\n\n    __uv.methods = {\n        setSource: methodPrefix + 'setSource',\n        source: methodPrefix + 'source',\n        location: methodPrefix + 'location',\n        function: methodPrefix + 'function',\n        string: methodPrefix + 'string',\n        eval: methodPrefix + 'eval',\n        parent: methodPrefix + 'parent',\n        top: methodPrefix + 'top',\n    };\n\n    __uv.filterKeys = [\n        master,\n        __uv.methods.setSource,\n        __uv.methods.source,\n        __uv.methods.location,\n        __uv.methods.function,\n        __uv.methods.string,\n        __uv.methods.eval,\n        __uv.methods.parent,\n        __uv.methods.top,\n        methodPrefix + 'protocol',\n        methodPrefix + 'storageObj',\n        methodPrefix + 'url',\n        methodPrefix + 'modifiedStyle',\n        methodPrefix + 'config',\n        methodPrefix + 'dispatched',\n        'Ultraviolet',\n        '__uvHook',\n    ];\n\n    client.on('wrap', (target, wrapped) => {\n        client.nativeMethods.defineProperty(\n            wrapped,\n            'name',\n            client.nativeMethods.getOwnPropertyDescriptor(target, 'name')\n        );\n        client.nativeMethods.defineProperty(\n            wrapped,\n            'length',\n            client.nativeMethods.getOwnPropertyDescriptor(target, 'length')\n        );\n\n        client.nativeMethods.defineProperty(wrapped, __uv.methods.string, {\n            enumerable: false,\n            value: client.nativeMethods.fnToString.call(target),\n        });\n\n        client.nativeMethods.defineProperty(wrapped, __uv.methods.function, {\n            enumerable: false,\n            value: target,\n        });\n    });\n\n    client.fetch.on('request', (event) => {\n        event.data.input = __uv.rewriteUrl(event.data.input);\n    });\n\n    client.fetch.on('requestUrl', (event) => {\n        event.data.value = __uv.sourceUrl(event.data.value);\n    });\n\n    client.fetch.on('responseUrl', (event) => {\n        event.data.value = __uv.sourceUrl(event.data.value);\n    });\n\n    // XMLHttpRequest\n    client.xhr.on('open', (event) => {\n        event.data.input = __uv.rewriteUrl(event.data.input);\n    });\n\n    client.xhr.on('responseUrl', (event) => {\n        event.data.value = __uv.sourceUrl(event.data.value);\n    });\n\n    // Workers\n    client.workers.on('worker', (event) => {\n        event.data.url = __uv.rewriteUrl(event.data.url);\n    });\n\n    client.workers.on('addModule', (event) => {\n        event.data.url = __uv.rewriteUrl(event.data.url);\n    });\n\n    client.workers.on('importScripts', (event) => {\n        for (const i in event.data.scripts) {\n            event.data.scripts[i] = __uv.rewriteUrl(event.data.scripts[i]);\n        }\n    });\n\n    client.workers.on('postMessage', (event) => {\n        let to = event.data.origin;\n\n        event.data.origin = '*';\n        event.data.message = {\n            __data: event.data.message,\n            __origin: __uv.meta.url.origin,\n            __to: to,\n        };\n    });\n\n    // Navigator\n    client.navigator.on('sendBeacon', (event) => {\n        event.data.url = __uv.rewriteUrl(event.data.url);\n    });\n\n    // Cookies\n    client.document.on('getCookie', (event) => {\n        event.data.value = cookieStr;\n    });\n\n    client.document.on('setCookie', (event) => {\n        __uv.cookie.db().then((db) => {\n            __uv.cookie.setCookies(event.data.value, db, __uv.meta);\n\n            __uv.cookie.getCookies(db).then((cookies) => {\n                cookieStr = __uv.cookie.serialize(cookies, __uv.meta, true);\n            });\n        });\n\n        const cookie = __uv.cookie.setCookie(event.data.value)[0];\n\n        if (!cookie.path) cookie.path = '/';\n        if (!cookie.domain) cookie.domain = __uv.meta.url.hostname;\n\n        if (__uv.cookie.validateCookie(cookie, __uv.meta, true)) {\n            if (cookieStr.length) cookieStr += '; ';\n            cookieStr += `${cookie.name}=${cookie.value}`;\n        }\n\n        event.respondWith(event.data.value);\n    });\n\n    // HTML\n    client.element.on('setInnerHTML', (event) => {\n        switch (event.that.tagName) {\n            case 'SCRIPT':\n                event.data.value = __uv.js.rewrite(event.data.value);\n                break;\n            case 'STYLE':\n                event.data.value = __uv.rewriteCSS(event.data.value);\n                break;\n            default:\n                event.data.value = __uv.rewriteHtml(event.data.value);\n        }\n    });\n\n    client.element.on('getInnerHTML', (event) => {\n        switch (event.that.tagName) {\n            case 'SCRIPT':\n                event.data.value = __uv.js.source(event.data.value);\n                break;\n            default:\n                event.data.value = __uv.sourceHtml(event.data.value);\n        }\n    });\n\n    client.element.on('setOuterHTML', (event) => {\n        event.data.value = __uv.rewriteHtml(event.data.value, {\n            document: event.that.tagName === 'HTML',\n        });\n    });\n\n    client.element.on('getOuterHTML', (event) => {\n        switch (event.that.tagName) {\n            case 'HEAD':\n                event.data.value = __uv\n                    .sourceHtml(\n                        event.data.value.replace(\n                            /<head(.*)>(.*)<\\/head>/s,\n                            '<op-head$1>$2</op-head>'\n                        )\n                    )\n                    .replace(\n                        /<op-head(.*)>(.*)<\\/op-head>/s,\n                        '<head$1>$2</head>'\n                    );\n                break;\n            case 'BODY':\n                event.data.value = __uv\n                    .sourceHtml(\n                        event.data.value.replace(\n                            /<body(.*)>(.*)<\\/body>/s,\n                            '<op-body$1>$2</op-body>'\n                        )\n                    )\n                    .replace(\n                        /<op-body(.*)>(.*)<\\/op-body>/s,\n                        '<body$1>$2</body>'\n                    );\n                break;\n            default:\n                event.data.value = __uv.sourceHtml(event.data.value, {\n                    document: event.that.tagName === 'HTML',\n                });\n                break;\n        }\n\n        //event.data.value = __uv.sourceHtml(event.data.value, { document: event.that.tagName === 'HTML' });\n    });\n\n    client.document.on('write', (event) => {\n        if (!event.data.html.length) return false;\n        event.data.html = [__uv.rewriteHtml(event.data.html.join(''))];\n    });\n\n    client.document.on('writeln', (event) => {\n        if (!event.data.html.length) return false;\n        event.data.html = [__uv.rewriteHtml(event.data.html.join(''))];\n    });\n\n    client.element.on('insertAdjacentHTML', (event) => {\n        event.data.html = __uv.rewriteHtml(event.data.html);\n    });\n\n    // EventSource\n\n    client.eventSource.on('construct', (event) => {\n        event.data.url = __uv.rewriteUrl(event.data.url);\n    });\n\n    client.eventSource.on('url', (event) => {\n        event.data.url = __uv.rewriteUrl(event.data.url);\n    });\n\n    // IDB\n    client.idb.on('idbFactoryOpen', (event) => {\n        // Don't modify the Ultraviolet cookie database\n        if (event.data.name === '__op') return;\n        event.data.name = `${__uv.meta.url.origin}@${event.data.name}`;\n    });\n\n    client.idb.on('idbFactoryName', (event) => {\n        event.data.value = event.data.value.slice(\n            __uv.meta.url.origin.length + 1 /*the @*/\n        );\n    });\n\n    // History\n    client.history.on('replaceState', (event) => {\n        if (event.data.url)\n            event.data.url = __uv.rewriteUrl(\n                event.data.url,\n                '__uv' in event.that ? event.that.__uv.meta : __uv.meta\n            );\n    });\n    client.history.on('pushState', (event) => {\n        if (event.data.url)\n            event.data.url = __uv.rewriteUrl(\n                event.data.url,\n                '__uv' in event.that ? event.that.__uv.meta : __uv.meta\n            );\n    });\n\n    // Element get set attribute methods\n    client.element.on('getAttribute', (event) => {\n        if (\n            client.element.hasAttribute.call(\n                event.that,\n                __uv.attributePrefix + '-attr-' + event.data.name\n            )\n        ) {\n            event.respondWith(\n                event.target.call(\n                    event.that,\n                    __uv.attributePrefix + '-attr-' + event.data.name\n                )\n            );\n        }\n    });\n\n    // Message\n    client.message.on('postMessage', (event) => {\n        let to = event.data.origin;\n        let call = __uv.call;\n\n        if (event.that) {\n            call = event.that.__uv$source.call;\n        }\n\n        event.data.origin = '*';\n        event.data.message = {\n            __data: event.data.message,\n            __origin: (event.that || event.target).__uv$source.location.origin,\n            __to: to,\n        };\n\n        event.respondWith(\n            worker\n                ? call(\n                      event.target,\n                      [event.data.message, event.data.transfer],\n                      event.that\n                  )\n                : call(\n                      event.target,\n                      [\n                          event.data.message,\n                          event.data.origin,\n                          event.data.transfer,\n                      ],\n                      event.that\n                  )\n        );\n    });\n\n    client.message.on('data', (event) => {\n        const { value: data } = event.data;\n        if (\n            typeof data === 'object' &&\n            '__data' in data &&\n            '__origin' in data\n        ) {\n            event.respondWith(data.__data);\n        }\n    });\n\n    client.message.on('origin', (event) => {\n        const data = client.message.messageData.get.call(event.that);\n        if (typeof data === 'object' && data.__data && data.__origin) {\n            event.respondWith(data.__origin);\n        }\n    });\n\n    client.overrideDescriptor(window, 'origin', {\n        get: () => {\n            return __uv.location.origin;\n        },\n    });\n\n    client.node.on('baseURI', (event) => {\n        if (event.data.value.startsWith(window.location.origin))\n            event.data.value = __uv.sourceUrl(event.data.value);\n    });\n\n    client.element.on('setAttribute', (event) => {\n        if (\n            event.that instanceof HTMLMediaElement &&\n            event.data.name === 'src' &&\n            event.data.value.startsWith('blob:')\n        ) {\n            event.target.call(\n                event.that,\n                __uv.attributePrefix + '-attr-' + event.data.name,\n                event.data.value\n            );\n            event.data.value = __uv.blobUrls.get(event.data.value);\n            return;\n        }\n\n        if (__uv.attrs.isUrl(event.data.name)) {\n            event.target.call(\n                event.that,\n                __uv.attributePrefix + '-attr-' + event.data.name,\n                event.data.value\n            );\n            event.data.value = __uv.rewriteUrl(event.data.value);\n        }\n\n        if (__uv.attrs.isStyle(event.data.name)) {\n            event.target.call(\n                event.that,\n                __uv.attributePrefix + '-attr-' + event.data.name,\n                event.data.value\n            );\n            event.data.value = __uv.rewriteCSS(event.data.value, {\n                context: 'declarationList',\n            });\n        }\n\n        if (__uv.attrs.isHtml(event.data.name)) {\n            event.target.call(\n                event.that,\n                __uv.attributePrefix + '-attr-' + event.data.name,\n                event.data.value\n            );\n            event.data.value = __uv.rewriteHtml(event.data.value, {\n                ...__uv.meta,\n                document: true,\n                injectHead: __uv.createHtmlInject(\n                    __uv.handlerScript,\n                    __uv.bundleScript,\n                    __uv.clientScript,\n                    __uv.configScript,\n                    __uv$bareURL,\n                    __uv$bareData,\n                    cookieStr,\n                    window.location.href\n                ),\n            });\n        }\n\n        if (__uv.attrs.isSrcset(event.data.name)) {\n            event.target.call(\n                event.that,\n                __uv.attributePrefix + '-attr-' + event.data.name,\n                event.data.value\n            );\n            event.data.value = __uv.html.wrapSrcset(\n                event.data.value.toString()\n            );\n        }\n\n        if (__uv.attrs.isForbidden(event.data.name)) {\n            event.data.name = __uv.attributePrefix + '-attr-' + event.data.name;\n        }\n    });\n\n    client.element.on('audio', (event) => {\n        event.data.url = __uv.rewriteUrl(event.data.url);\n    });\n\n    // Element Property Attributes\n    client.element.hookProperty(\n        [HTMLAnchorElement, HTMLAreaElement, HTMLLinkElement, HTMLBaseElement],\n        'href',\n        {\n            get: (target, that) => {\n                return __uv.sourceUrl(target.call(that));\n            },\n            set: (target, that, [val]) => {\n                client.element.setAttribute.call(\n                    that,\n                    __uv.attributePrefix + '-attr-href',\n                    val\n                );\n                target.call(that, __uv.rewriteUrl(val));\n            },\n        }\n    );\n\n    client.element.hookProperty(\n        [\n            HTMLScriptElement,\n            HTMLAudioElement,\n            HTMLVideoElement,\n            HTMLMediaElement,\n            HTMLImageElement,\n            HTMLInputElement,\n            HTMLEmbedElement,\n            HTMLIFrameElement,\n            HTMLTrackElement,\n            HTMLSourceElement,\n        ],\n        'src',\n        {\n            get: (target, that) => {\n                return __uv.sourceUrl(target.call(that));\n            },\n            set: (target, that, [val]) => {\n                if (\n                    new String(val).toString().trim().startsWith('blob:') &&\n                    that instanceof HTMLMediaElement\n                ) {\n                    client.element.setAttribute.call(\n                        that,\n                        __uv.attributePrefix + '-attr-src',\n                        val\n                    );\n                    return target.call(that, __uv.blobUrls.get(val) || val);\n                }\n\n                client.element.setAttribute.call(\n                    that,\n                    __uv.attributePrefix + '-attr-src',\n                    val\n                );\n                target.call(that, __uv.rewriteUrl(val));\n            },\n        }\n    );\n\n    client.element.hookProperty([HTMLFormElement], 'action', {\n        get: (target, that) => {\n            return __uv.sourceUrl(target.call(that));\n        },\n        set: (target, that, [val]) => {\n            client.element.setAttribute.call(\n                that,\n                __uv.attributePrefix + '-attr-action',\n                val\n            );\n            target.call(that, __uv.rewriteUrl(val));\n        },\n    });\n\n    client.element.hookProperty([HTMLImageElement], 'srcset', {\n        get: (target, that) => {\n            return (\n                client.element.getAttribute.call(\n                    that,\n                    __uv.attributePrefix + '-attr-srcset'\n                ) || target.call(that)\n            );\n        },\n        set: (target, that, [val]) => {\n            client.element.setAttribute.call(\n                that,\n                __uv.attributePrefix + '-attr-srcset',\n                val\n            );\n            target.call(that, __uv.html.wrapSrcset(val.toString()));\n        },\n    });\n\n    client.element.hookProperty(HTMLScriptElement, 'integrity', {\n        get: (target, that) => {\n            return client.element.getAttribute.call(\n                that,\n                __uv.attributePrefix + '-attr-integrity'\n            );\n        },\n        set: (target, that, [val]) => {\n            client.element.setAttribute.call(\n                that,\n                __uv.attributePrefix + '-attr-integrity',\n                val\n            );\n        },\n    });\n\n    client.element.hookProperty(HTMLIFrameElement, 'sandbox', {\n        get: (target, that) => {\n            return (\n                client.element.getAttribute.call(\n                    that,\n                    __uv.attributePrefix + '-attr-sandbox'\n                ) || target.call(that)\n            );\n        },\n        set: (target, that, [val]) => {\n            client.element.setAttribute.call(\n                that,\n                __uv.attributePrefix + '-attr-sandbox',\n                val\n            );\n        },\n    });\n\n    // HTMLIFrameElement may not be defined (workers)\n    const contentWindowGet =\n        HTMLIFrameElement &&\n        Object.getOwnPropertyDescriptor(\n            HTMLIFrameElement.prototype,\n            'contentWindow'\n        ).get;\n\n    function uvInject(that) {\n        const win = contentWindowGet.call(that);\n\n        if (!win.__uv)\n            try {\n                __uvHook(win);\n            } catch (e) {\n                console.error('catastrophic failure');\n                console.error(e);\n            }\n    }\n\n    client.element.hookProperty(HTMLIFrameElement, 'contentWindow', {\n        get: (target, that) => {\n            uvInject(that);\n            return target.call(that);\n        },\n    });\n\n    client.element.hookProperty(HTMLIFrameElement, 'contentDocument', {\n        get: (target, that) => {\n            uvInject(that);\n            return target.call(that);\n        },\n    });\n\n    client.element.hookProperty(HTMLIFrameElement, 'srcdoc', {\n        get: (target, that) => {\n            return (\n                client.element.getAttribute.call(\n                    that,\n                    __uv.attributePrefix + '-attr-srcdoc'\n                ) || target.call(that)\n            );\n        },\n        set: (target, that, [val]) => {\n            target.call(\n                that,\n                __uv.rewriteHtml(val, {\n                    document: true,\n                    injectHead: __uv.createHtmlInject(\n                        __uv.handlerScript,\n                        __uv.bundleScript,\n                        __uv.clientScript,\n                        __uv.configScript,\n                        __uv$bareURL,\n                        __uv$bareData,\n                        cookieStr,\n                        window.location.href\n                    ),\n                })\n            );\n        },\n    });\n\n    client.node.on('getTextContent', (event) => {\n        if (event.that.tagName === 'SCRIPT') {\n            event.data.value = __uv.js.source(event.data.value);\n        }\n    });\n\n    client.node.on('setTextContent', (event) => {\n        if (event.that.tagName === 'SCRIPT') {\n            event.data.value = __uv.js.rewrite(event.data.value);\n        }\n    });\n\n    // Until proper rewriting is implemented for service workers.\n    // Not sure atm how to implement it with the already built in service worker\n    if ('serviceWorker' in window.navigator) {\n        delete window.Navigator.prototype.serviceWorker;\n    }\n\n    // Document\n    client.document.on('getDomain', (event) => {\n        event.data.value = __uv.domain;\n    });\n    client.document.on('setDomain', (event) => {\n        if (\n            !event.data.value\n                .toString()\n                .endsWith(__uv.meta.url.hostname.split('.').slice(-2).join('.'))\n        )\n            return event.respondWith('');\n        event.respondWith((__uv.domain = event.data.value));\n    });\n\n    client.document.on('url', (event) => {\n        event.data.value = __uv.location.href;\n    });\n\n    client.document.on('documentURI', (event) => {\n        event.data.value = __uv.location.href;\n    });\n\n    client.document.on('referrer', (event) => {\n        event.data.value = __uv.referrer || __uv.sourceUrl(event.data.value);\n    });\n\n    client.document.on('parseFromString', (event) => {\n        if (event.data.type !== 'text/html') return false;\n        event.data.string = __uv.rewriteHtml(event.data.string, {\n            ...__uv.meta,\n            document: true,\n        });\n    });\n\n    // Attribute (node.attributes)\n    client.attribute.on('getValue', (event) => {\n        if (\n            client.element.hasAttribute.call(\n                event.that.ownerElement,\n                __uv.attributePrefix + '-attr-' + event.data.name\n            )\n        ) {\n            event.data.value = client.element.getAttribute.call(\n                event.that.ownerElement,\n                __uv.attributePrefix + '-attr-' + event.data.name\n            );\n        }\n    });\n\n    client.attribute.on('setValue', (event) => {\n        if (__uv.attrs.isUrl(event.data.name)) {\n            client.element.setAttribute.call(\n                event.that.ownerElement,\n                __uv.attributePrefix + '-attr-' + event.data.name,\n                event.data.value\n            );\n            event.data.value = __uv.rewriteUrl(event.data.value);\n        }\n\n        if (__uv.attrs.isStyle(event.data.name)) {\n            client.element.setAttribute.call(\n                event.that.ownerElement,\n                __uv.attributePrefix + '-attr-' + event.data.name,\n                event.data.value\n            );\n            event.data.value = __uv.rewriteCSS(event.data.value, {\n                context: 'declarationList',\n            });\n        }\n\n        if (__uv.attrs.isHtml(event.data.name)) {\n            client.element.setAttribute.call(\n                event.that.ownerElement,\n                __uv.attributePrefix + '-attr-' + event.data.name,\n                event.data.value\n            );\n            event.data.value = __uv.rewriteHtml(event.data.value, {\n                ...__uv.meta,\n                document: true,\n                injectHead: __uv.createHtmlInject(\n                    __uv.handlerScript,\n                    __uv.bundleScript,\n                    __uv.clientScript,\n                    __uv.configScript,\n                    __uv$bareURL,\n                    __uv$bareData,\n                    cookieStr,\n                    window.location.href\n                ),\n            });\n        }\n\n        if (__uv.attrs.isSrcset(event.data.name)) {\n            client.element.setAttribute.call(\n                event.that.ownerElement,\n                __uv.attributePrefix + '-attr-' + event.data.name,\n                event.data.value\n            );\n            event.data.value = __uv.html.wrapSrcset(\n                event.data.value.toString()\n            );\n        }\n    });\n\n    // URL\n    client.url.on('createObjectURL', (event) => {\n        let url = event.target.call(event.that, event.data.object);\n        if (url.startsWith('blob:' + location.origin)) {\n            let newUrl =\n                'blob:' +\n                (__uv.meta.url.href !== 'about:blank'\n                    ? __uv.meta.url.origin\n                    : window.parent.__uv.meta.url.origin) +\n                url.slice('blob:'.length + location.origin.length);\n            __uv.blobUrls.set(newUrl, url);\n            event.respondWith(newUrl);\n        } else {\n            event.respondWith(url);\n        }\n    });\n\n    client.url.on('revokeObjectURL', (event) => {\n        if (__uv.blobUrls.has(event.data.url)) {\n            const old = event.data.url;\n            event.data.url = __uv.blobUrls.get(event.data.url);\n            __uv.blobUrls.delete(old);\n        }\n    });\n\n    client.storage.on('get', (event) => {\n        event.data.name =\n            methodPrefix + __uv.meta.url.origin + '@' + event.data.name;\n    });\n\n    client.storage.on('set', (event) => {\n        if (event.that.__uv$storageObj) {\n            event.that.__uv$storageObj[event.data.name] = event.data.value;\n        }\n        event.data.name =\n            methodPrefix + __uv.meta.url.origin + '@' + event.data.name;\n    });\n\n    client.storage.on('delete', (event) => {\n        if (event.that.__uv$storageObj) {\n            delete event.that.__uv$storageObj[event.data.name];\n        }\n        event.data.name =\n            methodPrefix + __uv.meta.url.origin + '@' + event.data.name;\n    });\n\n    client.storage.on('getItem', (event) => {\n        event.data.name =\n            methodPrefix + __uv.meta.url.origin + '@' + event.data.name;\n    });\n\n    client.storage.on('setItem', (event) => {\n        if (event.that.__uv$storageObj) {\n            event.that.__uv$storageObj[event.data.name] = event.data.value;\n        }\n        event.data.name =\n            methodPrefix + __uv.meta.url.origin + '@' + event.data.name;\n    });\n\n    client.storage.on('removeItem', (event) => {\n        if (event.that.__uv$storageObj) {\n            delete event.that.__uv$storageObj[event.data.name];\n        }\n        event.data.name =\n            methodPrefix + __uv.meta.url.origin + '@' + event.data.name;\n    });\n\n    client.storage.on('clear', (event) => {\n        if (event.that.__uv$storageObj) {\n            for (const key of client.nativeMethods.keys.call(\n                null,\n                event.that.__uv$storageObj\n            )) {\n                delete event.that.__uv$storageObj[key];\n                client.storage.removeItem.call(\n                    event.that,\n                    methodPrefix + __uv.meta.url.origin + '@' + key\n                );\n                event.respondWith();\n            }\n        }\n    });\n\n    client.storage.on('length', (event) => {\n        if (event.that.__uv$storageObj) {\n            event.respondWith(\n                client.nativeMethods.keys.call(null, event.that.__uv$storageObj)\n                    .length\n            );\n        }\n    });\n\n    client.storage.on('key', (event) => {\n        if (event.that.__uv$storageObj) {\n            event.respondWith(\n                client.nativeMethods.keys.call(\n                    null,\n                    event.that.__uv$storageObj\n                )[event.data.index] || null\n            );\n        }\n    });\n\n    function eventTarget(target, event) {\n        const property = `on${event}`;\n        const listeners = new WeakMap();\n\n        Reflect.defineProperty(target, property, {\n            enumerable: true,\n            configurable: true,\n            get() {\n                if (listeners.has(this)) {\n                    return listeners.get(this);\n                } else {\n                    return null;\n                }\n            },\n            set(value) {\n                if (typeof value == 'function') {\n                    if (listeners.has(this)) {\n                        this.removeEventListener(event, listeners.get(this));\n                    }\n\n                    listeners.set(this, value);\n                    this.addEventListener(event, value);\n                }\n            },\n        });\n    }\n\n    const wsProtocols = ['ws:', 'wss:'];\n\n    class MockWebSocket extends EventTarget {\n        /**\n         * @type {import(\"@tomphttp/bare-client\").BareWebSocket}\n         */\n        #socket;\n        #ready;\n        #binaryType = 'blob';\n        #protocol = '';\n        #extensions = '';\n        #url = '';\n        /**\n         *\n         * @param {URL} remote\n         * @param {any} protocol\n         */\n        async #open(url, protocol) {\n            const requestHeaders = {};\n            Reflect.setPrototypeOf(requestHeaders, null);\n\n            requestHeaders['Origin'] = __uv.meta.url.origin;\n            requestHeaders['User-Agent'] = navigator.userAgent;\n\n            if (cookieStr !== '')\n                requestHeaders['Cookie'] = cookieStr.toString();\n\n            this.#socket = await bareClient.createWebSocket(\n                url,\n                requestHeaders,\n                protocol\n            );\n\n            this.#socket.binaryType = this.#binaryType;\n\n            this.#socket.addEventListener('message', (event) => {\n                this.dispatchEvent(new MessageEvent('message', event));\n            });\n\n            this.#socket.addEventListener('open', async (event) => {\n                this.dispatchEvent(new Event('open', event));\n            });\n\n            this.#socket.addEventListener('error', (event) => {\n                this.dispatchEvent(new ErrorEvent('error', event));\n            });\n\n            this.#socket.addEventListener('close', (event) => {\n                this.dispatchEvent(new Event('close', event));\n            });\n\n            const meta = await this.#socket.meta;\n\n            if (meta.headers.has('sec-websocket-protocol'))\n                this.#protocol = meta.headers.get('sec-websocket-protocol');\n\n            if (meta.headers.has('sec-websocket-extensions'))\n                this.#extensions = meta.headers.get('sec-websocket-extensions');\n\n            let setCookie = meta.rawHeaders['set-cookie'] || [];\n            if (!Array.isArray(setCookie)) setCookie = [];\n            // trip the hook\n            for (const cookie of setCookie) document.cookie = cookie;\n        }\n        get url() {\n            return this.#url;\n        }\n        constructor(...args) {\n            super();\n\n            if (!args.length)\n                throw new DOMException(\n                    `Failed to construct 'WebSocket': 1 argument required, but only 0 present.`\n                );\n\n            const [url, protocol] = args;\n\n            let parsed;\n\n            try {\n                parsed = new URL(url);\n            } catch (err) {\n                throw new DOMException(\n                    `Faiiled to construct 'WebSocket': The URL '${url}' is invalid.`\n                );\n            }\n\n            if (!wsProtocols.includes(parsed.protocol)) {\n                throw new DOMException(\n                    `Failed to construct 'WebSocket': The URL's scheme must be either 'ws' or 'wss'. '${parsed.protocol}' is not allowed.`\n                );\n            }\n\n            this.#ready = this.#open(parsed, protocol);\n        }\n        get protocol() {\n            return this.#protocol;\n        }\n        get extensions() {\n            return this.#extensions;\n        }\n        get readyState() {\n            if (this.#socket) {\n                return this.#socket.readyState;\n            } else {\n                return MockWebSocket.CONNECTING;\n            }\n        }\n        get binaryType() {\n            return this.#binaryType;\n        }\n        set binaryType(value) {\n            this.#binaryType = value;\n\n            if (this.#socket) {\n                this.#socket.binaryType = value;\n            }\n        }\n        send(data) {\n            if (!this.#socket) {\n                throw new DOMException(\n                    `Failed to execute 'send' on 'WebSocket': Still in CONNECTING state.`\n                );\n            }\n            this.#socket.send(data);\n        }\n        close(code, reason) {\n            if (typeof code !== 'undefined') {\n                if (typeof code !== 'number') {\n                    code = 0;\n                }\n\n                if (code !== 1000 && (code < 3000 || code > 4999)) {\n                    throw new DOMException(\n                        `Failed to execute 'close' on 'WebSocket': The code must be either 1000, or between 3000 and 4999. ${code} is neither.`\n                    );\n                }\n            }\n\n            this.#ready.then(() => this.#socket.close(code, reason));\n        }\n    }\n\n    eventTarget(MockWebSocket.prototype, 'close');\n    eventTarget(MockWebSocket.prototype, 'open');\n    eventTarget(MockWebSocket.prototype, 'message');\n    eventTarget(MockWebSocket.prototype, 'error');\n\n    for (const hook of [\n        'url',\n        'protocol',\n        'extensions',\n        'readyState',\n        'binaryType',\n    ]) {\n        const officialDesc = Object.getOwnPropertyDescriptor(\n            window.WebSocket.prototype,\n            hook\n        );\n        const customDesc = Object.getOwnPropertyDescriptor(\n            MockWebSocket.prototype,\n            hook\n        );\n\n        if (customDesc?.get && officialDesc?.get)\n            client.emit('wrap', customDesc.get, officialDesc.get);\n\n        if (customDesc?.set && officialDesc?.set)\n            client.emit('wrap', customDesc.get, officialDesc.get);\n    }\n\n    client.emit(\n        'wrap',\n        window.WebSocket.prototype.send,\n        MockWebSocket.prototype.send\n    );\n    client.emit(\n        'wrap',\n        window.WebSocket.prototype.close,\n        MockWebSocket.prototype.close\n    );\n\n    client.override(\n        window,\n        'WebSocket',\n        (target, that, args) => new MockWebSocket(...args),\n        true\n    );\n\n    MockWebSocket.prototype.constructor = window.WebSocket;\n\n    client.function.on('function', (event) => {\n        event.data.script = __uv.rewriteJS(event.data.script);\n    });\n\n    client.function.on('toString', (event) => {\n        if (__uv.methods.string in event.that)\n            event.respondWith(event.that[__uv.methods.string]);\n    });\n\n    client.object.on('getOwnPropertyNames', (event) => {\n        event.data.names = event.data.names.filter(\n            (element) => !__uv.filterKeys.includes(element)\n        );\n    });\n\n    client.object.on('getOwnPropertyDescriptors', (event) => {\n        for (const forbidden of __uv.filterKeys) {\n            delete event.data.descriptors[forbidden];\n        }\n    });\n\n    client.style.on('setProperty', (event) => {\n        if (client.style.dashedUrlProps.includes(event.data.property)) {\n            event.data.value = __uv.rewriteCSS(event.data.value, {\n                context: 'value',\n                ...__uv.meta,\n            });\n        }\n    });\n\n    client.style.on('getPropertyValue', (event) => {\n        if (client.style.dashedUrlProps.includes(event.data.property)) {\n            event.respondWith(\n                __uv.sourceCSS(\n                    event.target.call(event.that, event.data.property),\n                    {\n                        context: 'value',\n                        ...__uv.meta,\n                    }\n                )\n            );\n        }\n    });\n\n    if ('CSS2Properties' in window) {\n        for (const key of client.style.urlProps) {\n            client.overrideDescriptor(window.CSS2Properties.prototype, key, {\n                get: (target, that) => {\n                    return __uv.sourceCSS(target.call(that), {\n                        context: 'value',\n                        ...__uv.meta,\n                    });\n                },\n                set: (target, that, val) => {\n                    target.call(\n                        that,\n                        __uv.rewriteCSS(val, {\n                            context: 'value',\n                            ...__uv.meta,\n                        })\n                    );\n                },\n            });\n        }\n    } else if ('HTMLElement' in window) {\n        client.overrideDescriptor(window.HTMLElement.prototype, 'style', {\n            get: (target, that) => {\n                const value = target.call(that);\n                if (!value[methodPrefix + 'modifiedStyle']) {\n                    for (const key of client.style.urlProps) {\n                        client.nativeMethods.defineProperty(value, key, {\n                            enumerable: true,\n                            configurable: true,\n                            get() {\n                                const value =\n                                    client.style.getPropertyValue.call(\n                                        this,\n                                        key\n                                    ) || '';\n                                return __uv.sourceCSS(value, {\n                                    context: 'value',\n                                    ...__uv.meta,\n                                });\n                            },\n                            set(val) {\n                                client.style.setProperty.call(\n                                    this,\n                                    client.style.propToDashed[key] || key,\n                                    __uv.rewriteCSS(val, {\n                                        context: 'value',\n                                        ...__uv.meta,\n                                    })\n                                );\n                            },\n                        });\n                        client.nativeMethods.defineProperty(\n                            value,\n                            methodPrefix + 'modifiedStyle',\n                            {\n                                enumerable: false,\n                                value: true,\n                            }\n                        );\n                    }\n                }\n                return value;\n            },\n        });\n    }\n\n    client.style.on('setCssText', (event) => {\n        event.data.value = __uv.rewriteCSS(event.data.value, {\n            context: 'declarationList',\n            ...__uv.meta,\n        });\n    });\n\n    client.style.on('getCssText', (event) => {\n        event.data.value = __uv.sourceCSS(event.data.value, {\n            context: 'declarationList',\n            ...__uv.meta,\n        });\n    });\n\n    // Proper hash emulation.\n    __uv.addEventListener.call(window, 'hashchange', (event) => {\n        if (event.__uv$dispatched) return false;\n        event.stopImmediatePropagation();\n        const hash = window.location.hash;\n        client.history.replaceState.call(window.history, '', '', event.oldURL);\n        __uv.location.hash = hash;\n    });\n\n    client.location.on('hashchange', (oldUrl, newUrl, ctx) => {\n        if (ctx.HashChangeEvent && client.history.replaceState) {\n            client.history.replaceState.call(\n                window.history,\n                '',\n                '',\n                __uv.rewriteUrl(newUrl)\n            );\n\n            const event = new ctx.HashChangeEvent('hashchange', {\n                newURL: newUrl,\n                oldURL: oldUrl,\n            });\n\n            client.nativeMethods.defineProperty(\n                event,\n                methodPrefix + 'dispatched',\n                {\n                    value: true,\n                    enumerable: false,\n                }\n            );\n\n            __uv.dispatchEvent.call(window, event);\n        }\n    });\n\n    // Hooking functions & descriptors\n    client.fetch.overrideRequest();\n    client.fetch.overrideUrl();\n    client.xhr.overrideOpen();\n    client.xhr.overrideResponseUrl();\n    client.element.overrideHtml();\n    client.element.overrideAttribute();\n    client.element.overrideInsertAdjacentHTML();\n    client.element.overrideAudio();\n    // client.element.overrideQuerySelector();\n    client.node.overrideBaseURI();\n    client.node.overrideTextContent();\n    client.attribute.overrideNameValue();\n    client.document.overrideDomain();\n    client.document.overrideURL();\n    client.document.overrideDocumentURI();\n    client.document.overrideWrite();\n    client.document.overrideReferrer();\n    client.document.overrideParseFromString();\n    client.storage.overrideMethods();\n    client.storage.overrideLength();\n    //client.document.overrideQuerySelector();\n    client.object.overrideGetPropertyNames();\n    client.object.overrideGetOwnPropertyDescriptors();\n    client.idb.overrideName();\n    client.idb.overrideOpen();\n    client.history.overridePushState();\n    client.history.overrideReplaceState();\n    client.eventSource.overrideConstruct();\n    client.eventSource.overrideUrl();\n    client.url.overrideObjectURL();\n    client.document.overrideCookie();\n    client.message.overridePostMessage();\n    client.message.overrideMessageOrigin();\n    client.message.overrideMessageData();\n    client.workers.overrideWorker();\n    client.workers.overrideAddModule();\n    client.workers.overrideImportScripts();\n    client.workers.overridePostMessage();\n    client.style.overrideSetGetProperty();\n    client.style.overrideCssText();\n    client.navigator.overrideSendBeacon();\n    client.function.overrideFunction();\n    client.function.overrideToString();\n    client.location.overrideWorkerLocation((href) => {\n        return new URL(__uv.sourceUrl(href));\n    });\n\n    client.overrideDescriptor(window, 'localStorage', {\n        get: (target, that) => {\n            return (that || window).__uv.lsWrap;\n        },\n    });\n    client.overrideDescriptor(window, 'sessionStorage', {\n        get: (target, that) => {\n            return (that || window).__uv.ssWrap;\n        },\n    });\n\n    client.override(window, 'open', (target, that, args) => {\n        if (!args.length) return target.apply(that, args);\n        let [url] = args;\n\n        url = __uv.rewriteUrl(url);\n\n        return target.call(that, url);\n    });\n\n    __uv.$wrap = function (name) {\n        if (name === 'location') return __uv.methods.location;\n        if (name === 'eval') return __uv.methods.eval;\n        return name;\n    };\n\n    __uv.$get = function (that) {\n        if (that === window.location) return __uv.location;\n        if (that === window.eval) return __uv.eval;\n        if (that === window.parent) {\n            return window.__uv$parent;\n        }\n        if (that === window.top) {\n            return window.__uv$top;\n        }\n        return that;\n    };\n\n    __uv.eval = client.wrap(window, 'eval', (target, that, args) => {\n        if (!args.length || typeof args[0] !== 'string')\n            return target.apply(that, args);\n        let [script] = args;\n\n        script = __uv.rewriteJS(script);\n        return target.call(that, script);\n    });\n\n    __uv.call = function (target, args, that) {\n        return that ? target.apply(that, args) : target(...args);\n    };\n\n    __uv.call$ = function (obj, prop, args = []) {\n        return obj[prop].apply(obj, args);\n    };\n\n    client.nativeMethods.defineProperty(window.Object.prototype, master, {\n        get: () => {\n            return __uv;\n        },\n        enumerable: false,\n    });\n\n    client.nativeMethods.defineProperty(\n        window.Object.prototype,\n        __uv.methods.setSource,\n        {\n            value: function (source) {\n                if (!client.nativeMethods.isExtensible(this)) return this;\n\n                client.nativeMethods.defineProperty(this, __uv.methods.source, {\n                    value: source,\n                    writable: true,\n                    enumerable: false,\n                });\n\n                return this;\n            },\n            enumerable: false,\n        }\n    );\n\n    client.nativeMethods.defineProperty(\n        window.Object.prototype,\n        __uv.methods.source,\n        {\n            value: __uv,\n            writable: true,\n            enumerable: false,\n        }\n    );\n\n    client.nativeMethods.defineProperty(\n        window.Object.prototype,\n        __uv.methods.location,\n        {\n            configurable: true,\n            get() {\n                return this === window.document || this === window\n                    ? __uv.location\n                    : this.location;\n            },\n            set(val) {\n                if (this === window.document || this === window) {\n                    __uv.location.href = val;\n                } else {\n                    this.location = val;\n                }\n            },\n        }\n    );\n\n    client.nativeMethods.defineProperty(\n        window.Object.prototype,\n        __uv.methods.parent,\n        {\n            configurable: true,\n            get() {\n                const val = this.parent;\n\n                if (this === window) {\n                    try {\n                        return '__uv' in val ? val : this;\n                    } catch (e) {\n                        return this;\n                    }\n                }\n                return val;\n            },\n            set(val) {\n                this.parent = val;\n            },\n        }\n    );\n\n    client.nativeMethods.defineProperty(\n        window.Object.prototype,\n        __uv.methods.top,\n        {\n            configurable: true,\n            get() {\n                const val = this.top;\n\n                if (this === window) {\n                    if (val === this.parent) return this[__uv.methods.parent];\n                    try {\n                        if (!('__uv' in val)) {\n                            let current = this;\n\n                            while (current.parent !== val) {\n                                current = current.parent;\n                            }\n\n                            return '__uv' in current ? current : this;\n                        } else {\n                            return val;\n                        }\n                    } catch (e) {\n                        return this;\n                    }\n                }\n                return val;\n            },\n            set(val) {\n                this.top = val;\n            },\n        }\n    );\n\n    client.nativeMethods.defineProperty(\n        window.Object.prototype,\n        __uv.methods.eval,\n        {\n            configurable: true,\n            get() {\n                return this === window ? __uv.eval : this.eval;\n            },\n            set(val) {\n                this.eval = val;\n            },\n        }\n    );\n}\n"],"names":["Ultraviolet","self","UVClient","__uv$config","__uv$bareData","__uv$bareURL","__uv$cookies","TypeError","__uvHook","window","__uv","document","querySelectorAll","forEach","node","remove","worker","master","methodPrefix","client","HTMLMediaElement","HTMLScriptElement","HTMLAudioElement","HTMLVideoElement","HTMLInputElement","HTMLEmbedElement","HTMLTrackElement","HTMLAnchorElement","HTMLIFrameElement","HTMLAreaElement","HTMLLinkElement","HTMLBaseElement","HTMLFormElement","HTMLImageElement","HTMLSourceElement","nativeMethods","defineProperty","value","enumerable","meta","origin","location","emulate","href","URL","startsWith","slice","length","sourceUrl","rewriteUrl","cookieStr","url","domain","host","blobUrls","Map","referrer","cookies","localStorageObj","sessionStorageObj","bareClient","BareClient","parent","EventTarget","addEventListener","prototype","removeListener","dispatchEvent","storage","storeProto","get","this","sessionStorage","localStorage","key","getItem","lsWrap","ssWrap","rawBase","baseURI","call","base","methods","setSource","source","function","string","eval","top","filterKeys","on","target","wrapped","getOwnPropertyDescriptor","fnToString","fetch","event","data","input","xhr","workers","i","scripts","to","message","__data","__origin","__to","navigator","cookie","db","then","setCookies","getCookies","serialize","setCookie","path","hostname","validateCookie","name","respondWith","element","that","tagName","js","rewrite","rewriteCSS","rewriteHtml","sourceHtml","replace","html","join","eventSource","idb","history","hasAttribute","attributePrefix","__uv$source","transfer","messageData","overrideDescriptor","attrs","isUrl","isStyle","context","isHtml","injectHead","createHtmlInject","handlerScript","bundleScript","clientScript","configScript","isSrcset","wrapSrcset","toString","isForbidden","hookProperty","set","val","setAttribute","String","trim","getAttribute","contentWindowGet","Object","uvInject","win","e","console","error","eventTarget","property","listeners","WeakMap","Reflect","configurable","has","removeEventListener","Navigator","serviceWorker","endsWith","split","type","attribute","ownerElement","object","newUrl","old","delete","__uv$storageObj","keys","removeItem","index","wsProtocols","MockWebSocket","async","protocol","requestHeaders","setPrototypeOf","userAgent","createWebSocket","binaryType","MessageEvent","Event","ErrorEvent","headers","rawHeaders","Array","isArray","constructor","args","super","DOMException","parsed","err","includes","extensions","readyState","CONNECTING","send","close","code","reason","hook","officialDesc","WebSocket","customDesc","emit","override","script","rewriteJS","names","filter","forbidden","descriptors","style","dashedUrlProps","sourceCSS","urlProps","CSS2Properties","HTMLElement","getPropertyValue","setProperty","propToDashed","__uv$dispatched","stopImmediatePropagation","hash","replaceState","oldURL","oldUrl","ctx","HashChangeEvent","newURL","overrideRequest","overrideUrl","overrideOpen","overrideResponseUrl","overrideHtml","overrideAttribute","overrideInsertAdjacentHTML","overrideAudio","overrideBaseURI","overrideTextContent","overrideNameValue","overrideDomain","overrideURL","overrideDocumentURI","overrideWrite","overrideReferrer","overrideParseFromString","overrideMethods","overrideLength","overrideGetPropertyNames","overrideGetOwnPropertyDescriptors","overrideName","overridePushState","overrideReplaceState","overrideConstruct","overrideObjectURL","overrideCookie","overridePostMessage","overrideMessageOrigin","overrideMessageData","overrideWorker","overrideAddModule","overrideImportScripts","overrideSetGetProperty","overrideCssText","overrideSendBeacon","overrideFunction","overrideToString","overrideWorkerLocation","apply","$wrap","$get","__uv$parent","__uv$top","wrap","call$","obj","prop","isExtensible","writable","current"],"sourceRoot":""}